class RedirectionList extends Charcoal.Admin.Widget{table;tableData=[];initialData=[];selector;constructor(t){super(t),this.selector=t.selector,console.log(t.redirections),this.tableData=JSON.parse(t.redirections),this.initialData=JSON.parse(JSON.stringify(this.tableData))}init(){this.table=new Tabulator(this.selector+" .js-tabulator",{data:this.tableData,maxHeight:"100vh",autoResize:!0,layout:"fitColumns",columns:[{field:"id",visible:!1},{title:"Path",field:"path",editor:"input",editorParams:{selectContents:!0}},{title:"Redirection",field:"redirect",editor:"input",editorParams:{selectContents:!0}},{title:"Redirect children",field:"redirectChildren",editor:"tickCross",formatter:"tickCross",editorParams:{}},{headerVisible:!1,headerSort:!1,width:150,cellClick:(t,e)=>{const i={"js-delete":()=>this.deleteRow(e.getRow()),"js-clone":()=>this.cloneRow(e.getRow()),"js-add-below":()=>this.addRow({},!1,e.getRow())};Object.keys(i).forEach((e=>{t.target.classList.contains(e)&&i[e]()}))},formatter:(t,e,i)=>'<div class="btn-group" role="group" aria-label="Basic example">\n                            <button type="button" class="btn btn-danger js-delete" title="Delete"><i class=\'fa fa-trash\' style="pointer-events: none;"></i></button>\n\x3c!--                            <button type="button" class="btn btn-secondary js-clone" title="Clone"><i class=\'fa fa-clone\' style="pointer-events: none;"></i></button>--\x3e\n\x3c!--                            <button type="button" class="btn btn-success js-add-below" title="Add row under"><i class=\'fa fa-plus\' style="pointer-events: none;"></i></button>--\x3e\n                        </div>'}]}),this.registerEvents()}registerEvents(){this.table.on("dataChanged",(function(t){console.log(t)})),this.element().on(`click.${this.type()}`,".js-add-row",(()=>{this.addRow()})),this.element().on(`click.${this.type()}`,".js-update",(()=>{let t=this.table.getData().filter((t=>!this.initialData.find((e=>JSON.stringify(e)===JSON.stringify(t)))));fetch("/admin/redirections/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((t=>{console.log("Request complete! response:",t)}))}))}deleteRow(t){t.delete(),this.table.redraw()}cloneRow(t){this.addRow(t.getData(),!1,t)}addRow(t={},e=!1,i=null){this.table.addRow(t,e,i).then((t=>{this.table.redraw();let e=t.getCell("path").getElement();return setTimeout((()=>e.focus()),10),t}))}destroy(){this.element().off(`${this.type()}`)}}Charcoal.Admin.Redirect_Widget_Redirections_List=RedirectionList;export{RedirectionList};